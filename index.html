<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sviby Tagasiside</title>
    <!-- React ja Babel CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide-React Ikoonid (Reacti spetsiifiline versioon) -->
    <script src="https://unpkg.com/lucide-react"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        /* Kohandatud animatsioonid */
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-[#020617]">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        /**
         * LucideIcon abikomponent
         * Kasutab window.lucideReact objekti, et leida √µige ikoonikomponent.
         */
        const LucideIcon = ({ name, ...props }) => {
            const Icon = window.lucideReact ? window.lucideReact[name] : null;
            if (!Icon) return null;
            return <Icon {...props} />;
        };

        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxYlOi06A-nNNjuojq73KutIFhVh9-Qbxh5a_RuL230ZN_D2hsXRId7iaMY8yJKfAYl/exec";

        const App = () => {
            const [step, setStep] = useState(0);
            const [isSubmitting, setIsSubmitting] = useState(false);
            const [submitStatus, setSubmitStatus] = useState(null);
            const [formData, setFormData] = useState({
                rating10: 0,
                positive: '',
                improvements: '',
                rating5: 0,
                suggestions: '',
                channels: [],
                extra: '',
                timestamp: ''
            });

            const channelsList = [
                "Facebook (grupid, s√ºndmused)",
                "Instagram",
                "Koduleht",
                "E-post / uudiskiri",
                "Kohalik meedia (ajaleht, portaal)",
                "S√µbrad / tuttavad",
                "Plakatid / kuulutused t√§naval"
            ];

            const nextStep = () => {
                // Esimese sammu kontroll: reiting peab olema valitud
                if (step === 1 && formData.rating10 === 0) return;
                setStep(prev => prev + 1);
            };

            const prevStep = () => setStep(prev => prev - 1);

            const toggleChannel = (channel) => {
                setFormData(prev => ({
                    ...prev,
                    channels: prev.channels.includes(channel)
                        ? prev.channels.filter(c => c !== channel)
                        : [...prev.channels, channel]
                }));
            };

            const handleSubmit = async (e) => {
                if (e) e.preventDefault();
                setIsSubmitting(true);
                setSubmitStatus(null);

                const submissionData = {
                    ...formData,
                    timestamp: new Date().toLocaleString('et-EE')
                };

                try {
                    // Kasutame no-cors re≈æiimi Google Scripti jaoks
                    await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(submissionData),
                    });
                    setIsSubmitting(false);
                    setSubmitStatus('success');
                } catch (error) {
                    console.error("Viga saatmisel:", error);
                    setIsSubmitting(false);
                    setSubmitStatus('error');
                }
            };

            // Eduka saatmise vaade
            if (submitStatus === 'success') {
                return (
                    <div className="min-h-screen flex items-center justify-center p-6 text-center text-white fade-in">
                        <div className="max-w-md w-full space-y-8">
                            <div className="relative mx-auto w-24 h-24">
                                <div className="absolute inset-0 bg-cyan-500 rounded-full blur-2xl opacity-20 animate-pulse"></div>
                                <div className="relative w-24 h-24 bg-gradient-to-br from-cyan-400 to-blue-600 rounded-3xl flex items-center justify-center shadow-2xl rotate-3">
                                    <LucideIcon name="Check" size={48} strokeWidth={3} />
                                </div>
                            </div>
                            <div className="space-y-3">
                                <h2 className="text-5xl font-black tracking-tight italic uppercase">Tehtud!</h2>
                                <p className="text-slate-400 text-lg leading-relaxed">
                                    Suur t√§nu panuse eest! Sinu vastused aitavad meil j√§rgmised korrad veelgi paremaks muuta.
                                </p>
                            </div>
                            <button 
                                onClick={() => window.location.reload()}
                                className="w-full py-4 bg-slate-800 hover:bg-slate-700 text-white rounded-2xl font-bold transition-all border border-slate-700"
                            >
                                Alusta uuesti
                            </button>
                        </div>
                    </div>
                );
            }

            // Sammude definitsioonid
            const stepComponents = [
                // 0. Tervitus / Hero
                (
                    <div className="space-y-8 fade-in">
                        <div className="flex items-center gap-3">
                            <div className="px-4 py-1.5 bg-blue-500/10 border border-blue-500/20 rounded-full text-blue-400 text-xs font-black tracking-widest uppercase">
                                Tagasiside 2024
                            </div>
                        </div>
                        <h1 className="text-6xl sm:text-8xl font-black leading-[0.85] tracking-tighter text-white uppercase italic">
                            Aita meil <br />
                            <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">paremini</span> <br />
                            teha.
                        </h1>
                        <p className="text-lg text-slate-400 max-w-sm leading-relaxed font-medium">
                            V√µta 60 sekundit, et jagada oma kogemust. See t√§hendab meile k√µike.
                        </p>
                        <div className="pt-6">
                            <button 
                                onClick={nextStep}
                                className="group relative px-10 py-5 bg-blue-600 rounded-3xl font-black text-xl text-white hover:bg-blue-500 transition-all flex items-center gap-4 shadow-[0_20px_50px_rgba(37,99,235,0.3)] active:scale-95"
                            >
                                Alusta siit
                                <LucideIcon name="ChevronRight" />
                            </button>
                        </div>
                    </div>
                ),
                // 1. √úldine reiting (1-10)
                (
                    <div className="space-y-10 text-white fade-in">
                        <div className="space-y-2">
                            <p className="text-blue-500 font-bold tracking-[0.2em] text-xs uppercase">Samm 01 / 06</p>
                            <h2 className="text-4xl font-black tracking-tight leading-tight uppercase italic">Kuidas hindad √ºritust tervikuna?</h2>
                        </div>
                        <div className="grid grid-cols-5 gap-3 sm:gap-4">
                            {[...Array(10)].map((_, i) => (
                                <button
                                    key={i+1}
                                    onClick={() => { setFormData({...formData, rating10: i+1}); setTimeout(nextStep, 250); }}
                                    className={`h-14 sm:h-20 rounded-2xl border-2 transition-all text-xl sm:text-2xl font-black flex items-center justify-center
                                        ${formData.rating10 === i+1 ? 'bg-blue-600 border-blue-600 shadow-xl' : 'bg-slate-800/40 border-slate-800 hover:border-slate-600'}`}
                                >
                                    {i+1}
                                </button>
                            ))}
                        </div>
                        <div className="flex justify-between text-[10px] font-black text-slate-500 uppercase tracking-[0.15em]">
                            <span>üëé Pettumus</span>
                            <span>T√§ielik tipp! üëç</span>
                        </div>
                    </div>
                ),
                // 2. Vaba tekst (Positiivne/Negatiivne)
                (
                    <div className="space-y-8 text-white fade-in">
                        <div className="space-y-6">
                            <div className="flex items-center gap-4">
                                <div className="w-12 h-12 bg-rose-500/20 text-rose-400 rounded-2xl flex items-center justify-center">
                                    <LucideIcon name="Heart" size={24} fill="currentColor" />
                                </div>
                                <h2 className="text-2xl font-bold uppercase italic tracking-tight">Mis oli parim osa?</h2>
                            </div>
                            <textarea 
                                className="w-full bg-slate-900 border-2 border-slate-800 rounded-[2rem] p-6 focus:border-blue-500 outline-none transition-all text-lg min-h-[120px] placeholder:text-slate-700"
                                placeholder="K√µik, mis pani silma s√§rama..."
                                value={formData.positive}
                                onChange={(e) => setFormData({...formData, positive: e.target.value})}
                            />
                        </div>
                        <div className="space-y-6">
                            <div className="flex items-center gap-4">
                                <div className="w-12 h-12 bg-amber-500/20 text-amber-400 rounded-2xl flex items-center justify-center">
                                    <LucideIcon name="BarChart3" size={24} />
                                </div>
                                <h2 className="text-2xl font-bold uppercase italic tracking-tight">Kus me saame juurde panna?</h2>
                            </div>
                            <textarea 
                                className="w-full bg-slate-900 border-2 border-slate-800 rounded-[2rem] p-6 focus:border-blue-500 outline-none transition-all text-lg min-h-[120px] placeholder:text-slate-700"
                                placeholder="Ole aus..."
                                value={formData.improvements}
                                onChange={(e) => setFormData({...formData, improvements: e.target.value})}
                            />
                        </div>
                        <button onClick={nextStep} className="w-full py-5 bg-white text-slate-950 font-black rounded-3xl text-lg hover:bg-slate-200 transition-all active:scale-95">
                            J√§tka samas vaimus
                        </button>
                    </div>
                ),
                // 3. Korraldus (T√§rnid 1-5)
                (
                    <div className="space-y-12 text-center text-white fade-in">
                        <div className="space-y-4">
                            <h2 className="text-4xl font-black tracking-tight uppercase italic">Kuidas j√§id rahule korraldusega?</h2>
                            <p className="text-slate-500">Atmosf√§√§r, toitlustus ja ajakava.</p>
                        </div>
                        <div className="flex justify-center gap-4 sm:gap-6 py-4">
                            {[1, 2, 3, 4, 5].map((star) => (
                                <button
                                    key={star}
                                    onClick={() => { setFormData({...formData, rating5: star}); setTimeout(nextStep, 350); }}
                                    className="flex flex-col items-center gap-4 outline-none"
                                >
                                    <div className={`w-14 h-14 sm:w-20 sm:h-20 rounded-[1.75rem] flex items-center justify-center transition-all duration-300 
                                        ${formData.rating5 >= star ? 'bg-amber-400 text-white scale-110 shadow-lg shadow-amber-500/20' : 'bg-slate-800/50 text-slate-600'}`}>
                                        <LucideIcon name="Star" fill={formData.rating5 >= star ? "currentColor" : "none"} size={32} />
                                    </div>
                                </button>
                            ))}
                        </div>
                    </div>
                ),
                // 4. Ettepanekud tulevikuks
                (
                    <div className="space-y-8 text-white fade-in">
                        <div className="flex items-center gap-4">
                            <div className="w-12 h-12 bg-indigo-500/20 text-indigo-400 rounded-2xl flex items-center justify-center">
                                <LucideIcon name="MessageSquare" size={24} />
                            </div>
                            <h2 className="text-2xl font-bold uppercase italic tracking-tight">Milliseid esinejaid v√µi teemasid ootad?</h2>
                        </div>
                        <textarea 
                            className="w-full bg-slate-900 border-2 border-slate-800 rounded-[2rem] p-8 focus:border-blue-500 outline-none transition-all text-xl min-h-[200px] placeholder:text-slate-700"
                            placeholder="Sinu soovid j√§rgmiseks korraks..."
                            value={formData.suggestions}
                            onChange={(e) => setFormData({...formData, suggestions: e.target.value})}
                        />
                        <button onClick={nextStep} className="w-full py-5 bg-white text-slate-950 font-black rounded-3xl text-lg hover:bg-slate-200 transition-all active:scale-95">
                            Peaaegu valmis
                        </button>
                    </div>
                ),
                // 5. Infoallikad (Kanalid)
                (
                    <div className="space-y-8 text-white fade-in">
                        <h2 className="text-3xl font-black tracking-tight uppercase italic">Kust sa meie kohta infot said?</h2>
                        <div className="grid grid-cols-1 gap-3">
                            {channelsList.map((channel) => (
                                <button 
                                    key={channel}
                                    onClick={() => toggleChannel(channel)}
                                    className={`p-5 rounded-2xl border-2 transition-all flex items-center justify-between text-left active:scale-[0.98]
                                        ${formData.channels.includes(channel) ? 'border-blue-500 bg-blue-600/10 shadow-[0_0_20px_rgba(37,99,235,0.1)]' : 'border-slate-800 bg-slate-800/30 hover:border-slate-700'}`}
                                >
                                    <span className={`font-bold transition-colors ${formData.channels.includes(channel) ? 'text-white' : 'text-slate-500'}`}>{channel}</span>
                                    <div className={`w-6 h-6 rounded-lg flex items-center justify-center transition-all ${formData.channels.includes(channel) ? 'bg-blue-600 scale-110' : 'bg-slate-700'}`}>
                                        {formData.channels.includes(channel) && <LucideIcon name="Check" size={16} strokeWidth={4} />}
                                    </div>
                                </button>
                            ))}
                        </div>
                        <button onClick={nextStep} className="w-full py-5 bg-blue-600 font-black rounded-3xl text-lg text-white hover:bg-blue-500 transition-all shadow-xl">
                            Viimane samm
                        </button>
                    </div>
                ),
                // 6. Saatmine ja lisam√§rkused
                (
                    <div className="space-y-10 text-white fade-in">
                        <div className="space-y-4">
                            <h2 className="text-4xl font-black italic uppercase">Kas on veel midagi?</h2>
                            <p className="text-slate-500">Sinu viimased m√µtted v√µi tervitused meeskonnale.</p>
                            <textarea 
                                className="w-full bg-slate-900 border-2 border-slate-800 rounded-[2rem] p-6 focus:border-blue-500 outline-none transition-all text-lg min-h-[160px] placeholder:text-slate-700"
                                placeholder="Kirjuta siia..."
                                value={formData.extra}
                                onChange={(e) => setFormData({...formData, extra: e.target.value})}
                            />
                        </div>
                        <button 
                            onClick={handleSubmit}
                            disabled={isSubmitting}
                            className="w-full py-6 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-black text-2xl rounded-[2rem] shadow-2xl flex items-center justify-center gap-4 disabled:opacity-50 transition-all active:scale-[0.98]"
                        >
                            {isSubmitting ? <LucideIcon name="Loader2" className="animate-spin" size={32} /> : (
                                <React.Fragment>
                                    <LucideIcon name="Send" size={28} />
                                    SAADA VASTUSED
                                </React.Fragment>
                            )}
                        </button>
                    </div>
                )
            ];

            return (
                <div className="relative max-w-2xl mx-auto px-6 py-12 min-h-screen flex flex-col justify-center overflow-hidden">
                    {/* Tausta dekoratsioonid */}
                    <div className="fixed inset-0 pointer-events-none opacity-20">
                        <div className="absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-blue-600/30 rounded-full blur-[120px]"></div>
                        <div className="absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-indigo-600/30 rounded-full blur-[120px]"></div>
                    </div>

                    {/* P√§is */}
                    <div className="absolute top-12 left-6 right-6 flex justify-between items-center h-10 z-10">
                        <div className="flex items-center gap-3 font-black text-2xl tracking-tighter text-white">
                            <div className="w-10 h-10 bg-gradient-to-tr from-blue-600 to-cyan-400 rounded-xl flex items-center justify-center italic shadow-lg">S</div>
                            SVIBY
                        </div>
                        {step > 0 && !isSubmitting && (
                            <button onClick={prevStep} className="text-slate-500 hover:text-white uppercase text-[10px] tracking-widest font-black px-4 py-2 bg-slate-900/50 rounded-full border border-slate-800 transition-all">
                                Tagasi
                            </button>
                        )}
                    </div>

                    {/* Progressi indikaator */}
                    {step > 0 && (
                        <div className="absolute top-32 left-6 right-6 flex items-center gap-4 z-10">
                            <div className="flex-1 h-1 bg-slate-900 rounded-full overflow-hidden">
                                <div 
                                    className="h-full bg-gradient-to-r from-blue-500 to-cyan-400 transition-all duration-700 ease-out" 
                                    style={{ width: `${(step / 6) * 100}%` }}
                                ></div>
                            </div>
                            <span className="text-[10px] font-black text-slate-500">{step}/6</span>
                        </div>
                    )}

                    <div className="relative z-10">{stepComponents[step]}</div>
                </div>
            );
        };

        // Renderdamine
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
