<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Konguta Rahvamaja Tagasiside</title>
    <!-- React ja Babel CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide-React Ikoonid -->
    <script src="https://unpkg.com/lucide-react"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-[#020617]">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        const LucideIcon = ({ name, ...props }) => {
            const Icon = window.lucideReact ? window.lucideReact[name] : null;
            if (!Icon) return null;
            return <Icon {...props} />;
        };

        // KASUTA SIIA OMA GOOGLE SCRIPT URL-I
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxYlOi06A-nNNjuojq73KutIFhVh9-Qbxh5a_RuL230ZN_D2hsXRId7iaMY8yJKfAYl/exec";

        const App = () => {
            const [step, setStep] = useState(0);
            const [isSubmitting, setIsSubmitting] = useState(false);
            const [submitStatus, setSubmitStatus] = useState(null);
            const [formData, setFormData] = useState({
                rating10: 0,
                positive: '',
                expectations: '',
                rating5: 0,
                logisticsDetails: '',
                suggestions: '',
                channels: [],
                otherChannel: '',
                extra: ''
            });

            const channelsList = [
                "Facebook",
                "Instagram",
                "Elva valla koduleht",
                "Elvakultuur.ee",
                "Tartu kultuuriaken",
                "Kohalik ajaleht",
                "E-post / uudiskiri",
                "S√µbrad ja tuttavad",
                "Plakatid / kuulutused",
                "Muu"
            ];

            const canGoNext = () => {
                if (step === 1 && formData.rating10 === 0) return false;
                if (step === 4 && formData.rating5 === 0) return false;
                if (step === 8) return false; 
                return true;
            };

            const nextStep = () => {
                if (canGoNext()) setStep(prev => prev + 1);
            };

            const prevStep = () => setStep(prev => prev - 1);

            const toggleChannel = (channel) => {
                setFormData(prev => ({
                    ...prev,
                    channels: prev.channels.includes(channel)
                        ? prev.channels.filter(c => c !== channel)
                        : [...prev.channels, channel]
                }));
            };

            const handleSubmit = async (e) => {
                if (e) e.preventDefault();
                setIsSubmitting(true);
                setSubmitStatus(null);

                // Kombineerime kanalid ja "Muu" vastuse √ºheks tekstiks
                const finalChannelsArray = [...formData.channels];
                if (formData.channels.includes("Muu") && formData.otherChannel) {
                    const index = finalChannelsArray.indexOf("Muu");
                    finalChannelsArray[index] = `Muu: ${formData.otherChannel}`;
                }

                const submissionData = {
                    ...formData,
                    channels: finalChannelsArray.join(', '),
                    timestamp: new Date().toLocaleString('et-EE')
                };

                try {
                    await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(submissionData),
                    });
                    
                    setTimeout(() => {
                        setIsSubmitting(false);
                        setSubmitStatus('success');
                    }, 1200);

                } catch (error) {
                    console.error("Viga saatmisel:", error);
                    setIsSubmitting(false);
                    setSubmitStatus('error');
                }
            };

            if (submitStatus === 'success') {
                return (
                    <div className="min-h-screen flex items-center justify-center p-6 text-center text-white fade-in">
                        <div className="max-w-md w-full space-y-8">
                            <div className="relative mx-auto w-24 h-24">
                                <div className="absolute inset-0 bg-cyan-500 rounded-full blur-2xl opacity-20 animate-pulse"></div>
                                <div className="relative w-24 h-24 bg-gradient-to-br from-cyan-400 to-blue-600 rounded-3xl flex items-center justify-center shadow-2xl rotate-3">
                                    <LucideIcon name="Check" size={48} strokeWidth={3} />
                                </div>
                            </div>
                            <div className="space-y-3">
                                <h2 className="text-5xl font-black tracking-tight italic uppercase">Ait√§h!</h2>
                                <p className="text-slate-400 text-lg leading-relaxed">
                                    Sinu tagasiside on meile v√§ga oluline. See aitab Konguta rahvamajal s√ºndmusi veelgi paremini korraldada.
                                </p>
                            </div>
                            <button 
                                onClick={() => window.location.reload()}
                                className="w-full py-4 bg-slate-800 hover:bg-slate-700 text-white rounded-2xl font-bold transition-all border border-slate-700"
                            >
                                Alusta uuesti
                            </button>
                        </div>
                    </div>
                );
            }

            const stepComponents = [
                // 0. Tervitus
                (
                    <div className="space-y-8 fade-in text-left">
                        <div className="flex items-center gap-3">
                            <div className="px-4 py-1.5 bg-blue-500/10 border border-blue-500/20 rounded-full text-blue-400 text-xs font-black tracking-widest uppercase">
                                √úrituse tagasiside
                            </div>
                        </div>
                        <h1 className="text-6xl sm:text-8xl font-black leading-[0.85] tracking-tighter text-white uppercase italic">
                            Sinu <br />
                            <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">arvamus</span> <br />
                            loeb.
                        </h1>
                        <p className="text-lg text-slate-400 max-w-sm leading-relaxed font-medium">
                            Aita Konguta rahvamajal muuta s√ºndmusi veelgi paremaks. See v√µtab aega vaid hetke.
                        </p>
                        <div className="pt-6 text-center sm:text-left">
                            <button 
                                onClick={nextStep}
                                className="group relative px-10 py-5 bg-blue-600 rounded-3xl font-black text-xl text-white hover:bg-blue-500 transition-all flex items-center gap-4 shadow-[0_20px_50px_rgba(37,99,235,0.3)] active:scale-95"
                            >
                                Alusta siit
                                <LucideIcon name="ChevronRight" />
                            </button>
                        </div>
                    </div>
                ),
                // 1. √úldine hinne
                (
                    <div className="space-y-10 text-white fade-in">
                        <div className="space-y-2 text-left">
                            <p className="text-blue-500 font-bold tracking-[0.2em] text-xs uppercase">Samm 01 / 08</p>
                            <h2 className="text-4xl font-black tracking-tight leading-tight uppercase italic text-transparent bg-clip-text bg-gradient-to-r from-white to-slate-400">Hinda Konguta rahvamaja k√ºlastust tervikuna</h2>
                        </div>
                        <div className="grid grid-cols-5 gap-3 sm:gap-4">
                            {[...Array(10)].map((_, i) => (
                                <button
                                    key={i+1}
                                    onClick={() => setFormData({...formData, rating10: i+1})}
                                    className={`h-14 sm:h-20 rounded-2xl border-2 transition-all text-xl sm:text-2xl font-black flex items-center justify-center
                                        ${formData.rating10 === i+1 ? 'bg-blue-600 border-blue-600 shadow-xl scale-105' : 'bg-slate-800/40 border-slate-800 hover:border-slate-600'}`}
                                >
                                    {i+1}
                                </button>
                            ))}
                        </div>
                        <div className="flex justify-between text-[10px] font-black text-slate-500 uppercase tracking-[0.15em] px-1">
                            <span className="flex flex-col items-center">
                                <span>1</span>
                                <span>üëé Pettumus</span>
                            </span>
                            <span className="flex flex-col items-center">
                                <span>10</span>
                                <span>T√§ielik tipp! üëç</span>
                            </span>
                        </div>
                        <div className="pt-4">
                            <button 
                                onClick={nextStep}
                                disabled={formData.rating10 === 0}
                                className={`w-full py-5 rounded-3xl font-black text-lg transition-all flex items-center justify-center gap-3
                                    ${formData.rating10 !== 0 ? 'bg-white text-slate-950 hover:bg-slate-200 shadow-xl' : 'bg-slate-800 text-slate-600 cursor-not-allowed'}`}
                            >
                                EDASI
                                <LucideIcon name="ChevronRight" size={20} />
                            </button>
                        </div>
                    </div>
                ),
                // 2. Positiivne
                (
                    <div className="space-y-8 text-white fade-in text-left">
                        <div className="space-y-6">
                            <div className="flex items-center gap-4 text-left">
                                <div className="w-12 h-12 bg-rose-500/20 text-rose-400 rounded-2xl flex items-center justify-center shrink-0">
                                    <LucideIcon name="Heart" size={24} fill="currentColor" />
                                </div>
                                <h2 className="text-2xl font-bold uppercase italic tracking-tight leading-tight">Mis j√§i sulle √ºritusest k√µige positiivsemalt meelde?</h2>
                            </div>
                            <textarea 
                                className="w-full bg-slate-900 border-2 border-slate-800 rounded-[2rem] p-6 focus:border-blue-500 outline-none transition-all text-lg min-h-[160px] placeholder:text-slate-700"
                                placeholder="Kirjuta siia..."
                                value={formData.positive}
                                onChange={(e) => setFormData({...formData, positive: e.target.value})}
                            />
                        </div>
                        <button onClick={nextStep} className="w-full py-5 bg-white text-slate-950 font-black rounded-3xl text-lg hover:bg-slate-200 transition-all">
                            EDASI
                        </button>
                    </div>
                ),
                // 3. Ootused ja parendused
                (
                    <div className="space-y-8 text-white fade-in text-left">
                        <div className="space-y-6">
                            <div className="flex items-center gap-4 text-left">
                                <div className="w-12 h-12 bg-amber-500/20 text-amber-400 rounded-2xl flex items-center justify-center shrink-0">
                                    <LucideIcon name="AlertCircle" size={24} />
                                </div>
                                <h2 className="text-2xl font-bold uppercase italic tracking-tight leading-tight text-white">Kas oli midagi, mis ei vastanud sinu ootustele v√µi mida saaksime j√§rgmisel korral paremini teha?</h2>
                            </div>
                            <textarea 
                                className="w-full bg-slate-900 border-2 border-slate-800 rounded-[2rem] p-6 focus:border-blue-500 outline-none transition-all text-lg min-h-[160px] placeholder:text-slate-700"
                                placeholder="Sinu aus tagasiside..."
                                value={formData.expectations}
                                onChange={(e) => setFormData({...formData, expectations: e.target.value})}
                            />
                        </div>
                        <button onClick={nextStep} className="w-full py-5 bg-white text-slate-950 font-black rounded-3xl text-lg hover:bg-slate-200 transition-all">
                            EDASI
                        </button>
                    </div>
                ),
                // 4. Korraldus (T√§rnid)
                (
                    <div className="space-y-12 text-center text-white fade-in text-left">
                        <div className="space-y-4">
                            <p className="text-blue-500 font-bold tracking-[0.2em] text-xs uppercase">Samm 04 / 08</p>
                            <h2 className="text-3xl font-black tracking-tight uppercase italic leading-tight">Kuidas j√§id rahule √ºrituse korraldusliku poolega?</h2>
                            <p className="text-slate-500 text-sm">(atmosf√§√§r, info liikumine, ajakava, teenused)</p>
                        </div>
                        <div className="flex justify-center gap-2 sm:gap-4 py-4">
                            {[1, 2, 3, 4, 5].map((star) => (
                                <button
                                    key={star}
                                    onClick={() => setFormData({...formData, rating5: star})}
                                    className={`w-14 h-14 sm:w-20 sm:h-20 rounded-[1.5rem] flex items-center justify-center transition-all duration-300 border-2
                                        ${formData.rating5 >= star 
                                            ? 'bg-amber-400 border-amber-400 text-white scale-110 shadow-lg shadow-amber-500/20 rotate-1' 
                                            : 'bg-slate-800/40 border-slate-800 text-slate-600 hover:border-slate-700'}`}
                                >
                                    <LucideIcon 
                                        name="Star" 
                                        fill={formData.rating5 >= star ? "currentColor" : "none"} 
                                        size={32} 
                                    />
                                </button>
                            ))}
                        </div>
                        <div className="flex justify-between text-[10px] font-black text-slate-500 uppercase tracking-[0.15em] px-2 italic text-left">
                            <span>N√µrk</span>
                            <span>Suurep√§rane</span>
                        </div>
                        <div className="pt-4">
                            <button 
                                onClick={nextStep}
                                disabled={formData.rating5 === 0}
                                className={`w-full py-5 rounded-3xl font-black text-lg transition-all flex items-center justify-center gap-3
                                    ${formData.rating5 !== 0 ? 'bg-white text-slate-950 hover:bg-slate-200 shadow-xl' : 'bg-slate-800 text-slate-600 cursor-not-allowed'}`}
                            >
                                EDASI
                                <LucideIcon name="ChevronRight" size={20} />
                            </button>
                        </div>
                    </div>
                ),
                // 5. Korralduse t√§psustus
                (
                    <div className="space-y-8 text-white fade-in text-left">
                        <div className="space-y-6">
                            <div className="flex items-center gap-4">
                                <div className="w-12 h-12 bg-blue-500/20 text-blue-400 rounded-2xl flex items-center justify-center shrink-0">
                                    <LucideIcon name="Search" size={24} />
                                </div>
                                <h2 className="text-2xl font-bold uppercase italic tracking-tight leading-tight">Soovi korral t√§psusta √ºrituse korralduslikku poolt:</h2>
                            </div>
                            <textarea 
                                className="w-full bg-slate-900 border-2 border-slate-800 rounded-[2rem] p-6 focus:border-blue-500 outline-none transition-all text-lg min-h-[160px] placeholder:text-slate-700"
                                placeholder="M√µtted atmosf√§√§ri, info v√µi teenuste kohta..."
                                value={formData.logisticsDetails}
                                onChange={(e) => setFormData({...formData, logisticsDetails: e.target.value})}
                            />
                        </div>
                        <button onClick={nextStep} className="w-full py-5 bg-white text-slate-950 font-black rounded-3xl text-lg hover:bg-slate-200 transition-all">
                            EDASI
                        </button>
                    </div>
                ),
                // 6. Esinejad
                (
                    <div className="space-y-8 text-white fade-in text-left">
                        <div className="flex items-center gap-4 text-left">
                            <div className="w-12 h-12 bg-indigo-500/20 text-indigo-400 rounded-2xl flex items-center justify-center shrink-0">
                                <LucideIcon name="MessageSquare" size={24} />
                            </div>
                            <h2 className="text-2xl font-bold uppercase italic tracking-tight leading-tight">Milliseid esinejatest sooviksid n√§ha/kuulda meie j√§rgmistel √ºritustel?</h2>
                        </div>
                        <textarea 
                            className="w-full bg-slate-900 border-2 border-slate-800 rounded-[2rem] p-8 focus:border-blue-500 outline-none transition-all text-xl min-h-[200px] placeholder:text-slate-700"
                            placeholder="Lisa oma ettepanekud..."
                            value={formData.suggestions}
                            onChange={(e) => setFormData({...formData, suggestions: e.target.value})}
                        />
                        <button onClick={nextStep} className="w-full py-5 bg-white text-slate-950 font-black rounded-3xl text-lg hover:bg-slate-200 transition-all">
                            EDASI
                        </button>
                    </div>
                ),
                // 7. Kanalid
                (
                    <div className="space-y-8 text-white fade-in text-left">
                        <div className="space-y-2">
                            <h2 className="text-3xl font-black tracking-tight uppercase italic leading-tight text-transparent bg-clip-text bg-gradient-to-r from-white to-slate-400">Milliseid kanaleid sa tavaliselt kasutad, et kohalike s√ºndmuste ja uudistega kursis olla?</h2>
                            <p className="text-slate-500 font-bold uppercase text-[10px] tracking-widest">(V√µid valida mitu)</p>
                        </div>
                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            {channelsList.map((channel) => (
                                <button 
                                    key={channel}
                                    onClick={() => toggleChannel(channel)}
                                    className={`p-4 rounded-2xl border-2 transition-all flex items-center justify-between text-left active:scale-[0.98]
                                        ${formData.channels.includes(channel) ? 'border-blue-500 bg-blue-600/10 shadow-[0_0_20px_rgba(37,99,235,0.1)]' : 'border-slate-800 bg-slate-800/30 hover:border-slate-700'}`}
                                >
                                    <span className={`font-bold text-sm transition-colors ${formData.channels.includes(channel) ? 'text-white' : 'text-slate-500'}`}>{channel}</span>
                                    <div className={`w-5 h-5 rounded-lg flex items-center justify-center transition-all ${formData.channels.includes(channel) ? 'bg-blue-600 scale-110' : 'bg-slate-700'}`}>
                                        {formData.channels.includes(channel) && <LucideIcon name="Check" size={14} strokeWidth={4} />}
                                    </div>
                                </button>
                            ))}
                        </div>
                        
                        {formData.channels.includes("Muu") && (
                            <div className="mt-4 fade-in">
                                <input 
                                    type="text"
                                    className="w-full bg-slate-900 border-2 border-slate-800 rounded-2xl p-4 focus:border-blue-500 outline-none text-white transition-all shadow-inner"
                                    placeholder="Kirjuta siia muu infoallikas..."
                                    value={formData.otherChannel}
                                    onChange={(e) => setFormData({...formData, otherChannel: e.target.value})}
                                />
                            </div>
                        )}

                        <button onClick={nextStep} className="w-full py-5 bg-blue-600 font-black rounded-3xl text-lg text-white hover:bg-blue-500 transition-all shadow-xl mt-4">
                            EDASI
                        </button>
                    </div>
                ),
                // 8. Vaba v√§li
                (
                    <div className="space-y-10 text-white fade-in text-left">
                        <div className="space-y-4">
                            <h2 className="text-4xl font-black italic uppercase">Vaba v√§li</h2>
                            <p className="text-slate-500">Kas on veel midagi, mida soovid meiega jagada?</p>
                            <textarea 
                                className="w-full bg-slate-900 border-2 border-slate-800 rounded-[2rem] p-6 focus:border-blue-500 outline-none transition-all text-lg min-h-[160px] placeholder:text-slate-700"
                                placeholder="Kirjuta siia..."
                                value={formData.extra}
                                onChange={(e) => setFormData({...formData, extra: e.target.value})}
                            />
                        </div>
                        <button 
                            onClick={handleSubmit}
                            disabled={isSubmitting}
                            className="w-full py-6 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-black text-2xl rounded-[2rem] shadow-2xl flex items-center justify-center gap-4 disabled:opacity-50 transition-all active:scale-[0.98]"
                        >
                            {isSubmitting ? <LucideIcon name="Loader2" className="animate-spin" size={32} /> : (
                                <React.Fragment>
                                    <LucideIcon name="Send" size={28} className="-rotate-12" />
                                    SAADA TAGASISIDE
                                </React.Fragment>
                            )}
                        </button>
                    </div>
                )
            ];

            return (
                <div className="relative max-w-2xl mx-auto px-6 py-12 min-h-screen flex flex-col justify-center overflow-hidden">
                    {/* P√§is */}
                    <div className="absolute top-12 left-6 right-6 flex justify-between items-center h-10 z-10">
                        <div className="flex items-center gap-3 font-black text-xl sm:text-2xl tracking-tighter text-white">
                            <div className="w-10 h-10 bg-gradient-to-tr from-blue-600 to-cyan-400 rounded-xl flex items-center justify-center italic shadow-lg">K</div>
                            KONGUTA RAHVAMAJA
                        </div>
                        {step > 0 && !isSubmitting && (
                            <div className="flex items-center gap-2">
                                <button 
                                    onClick={prevStep} 
                                    className="text-slate-500 hover:text-white uppercase text-[10px] tracking-widest font-black px-4 py-2 bg-slate-900/50 rounded-full border border-slate-800 transition-all flex items-center gap-1"
                                >
                                    <LucideIcon name="ChevronLeft" size={12} />
                                    Tagasi
                                </button>
                                {canGoNext() && (
                                    <button 
                                        onClick={nextStep} 
                                        className="text-blue-400 hover:text-white uppercase text-[10px] tracking-widest font-black px-4 py-2 bg-blue-900/20 rounded-full border border-blue-800/50 transition-all flex items-center gap-1"
                                    >
                                        Edasi
                                        <LucideIcon name="ChevronRight" size={12} />
                                    </button>
                                )}
                            </div>
                        )}
                    </div>

                    {/* Progressi indikaator */}
                    {step > 0 && (
                        <div className="absolute top-32 left-6 right-6 flex items-center gap-4 z-10">
                            <div className="flex-1 h-1 bg-slate-900 rounded-full overflow-hidden">
                                <div 
                                    className="h-full bg-gradient-to-r from-blue-500 to-cyan-400 transition-all duration-700 ease-out" 
                                    style={{ width: `${(step / (stepComponents.length - 1)) * 100}%` }}
                                ></div>
                            </div>
                            <span className="text-[10px] font-black text-slate-500 tabular-nums">{step}/{stepComponents.length - 1}</span>
                        </div>
                    )}

                    <div className="relative z-10">{stepComponents[step]}</div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
